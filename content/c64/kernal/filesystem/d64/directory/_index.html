---
type: "manual"
title: "Directory Track"
linkTitle: "Directory"
description: "Directory track 18"
categories:
- c64
weight: 20
no_list: true
---
<p>
    The directory track is contained totally on track 18.
    Sectors 1&hellip;18 contain the directory entries whilst sector 0 contains the BAM (Block Availability Map) and disk
    name/ID.
</p>
<p>
    Since the directory is only 18 sectors large (19 less one for the BAM), and each sector can contain only 8 entries
    (32 bytes per entry), the maximum number of directory entries is 18 * 8 = 144.
</p>
<p>
    The first directory sector is always 18/1, even though the t/s pointer at 18/0 (first two bytes) might point
    somewhere else.
</p>
<p>
    It then follows the same chain structure as a normal file, using a sector interleave of 3.
    This makes the chain links go 18/1, 18/4, 18/7 etc.
</p>

<div class="row">
    <div class="col-6">
        <table class="diskMap">
            <thead>
            <tr>
                <th rowspan="2">Byte</th>
                <th colspan="8">Content</th>
                <th rowspan="2"></th>
            </tr>
            <tr>
                <th>7</th>
                <th>6</th>
                <th>5</th>
                <th>4</th>
                <th>3</th>
                <th>2</th>
                <th>1</th>
                <th>0</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td>00</td>
                <td class="blue"><small class="left">15</small></td>
                <td class="bb blue" colspan="6" rowspan="2">Location of next directory sector, 0x0000=end</td>
                <td class="br blue" ><small class="right">8</small></td>
                <td class="brb" rowspan="32">First Directory entry</td>
            </tr>
            <tr>
                <td>01</td>
                <td class="bb blue"><small class="left">7</small></td>
                <td class="brb blue" ><small class="right">0</small></td>
            </tr>
            <tr>
                <td>02</td>
                <td class="brb orange">Closed</td>
                <td class="brb yellow">Locked</td>
                <td class="brb grey">Save</td>
                <td class="brb unused"></td>
                <td class="brb grey" colspan="4"><small class="left">3</small><small class="right">0</small>File Type</td>
            </tr>
            <tr>
                <td>03</td>
                <td class="green"><small class="left">15</small></td>
                <td class="bb green" colspan="6" rowspan="2">Location of first sector of file</td>
                <td class="br green" ><small class="right">8</small></td>
            </tr>
            <tr>
                <td>04</td>
                <td class="bb green"><small class="left">7</small></td>
                <td class="brb green" ><small class="right">0</small></td>
            </tr>
            <tr>
                <td>05</td>
                <td class="brb" rowspan="16"></td>
                <td class="brb orange" colspan="7" rowspan="16">Filename in PETASCII padded with 0xA0</td>
            </tr>
            <tr><td>06</td></tr>
            <tr><td>07</td></tr>
            <tr><td>08</td></tr>
            <tr><td>09</td></tr>
            <tr><td>0A</td></tr>
            <tr><td>0B</td></tr>
            <tr><td>0C</td></tr>
            <tr><td>0D</td></tr>
            <tr><td>0E</td></tr>
            <tr><td>0F</td></tr>
            <tr><td>10</td></tr>
            <tr><td>11</td></tr>
            <tr><td>12</td></tr>
            <tr><td>13</td></tr>
            <tr><td>14</td></tr>
            <tr>
                <td>15</td>
                <td class="green"><small class="left">15</small></td>
                <td class="bb green" colspan="6" rowspan="2">Location of first side-sector block</td>
                <td class="br green" ><small class="right">8</small></td>
            </tr>
            <tr>
                <td>16</td>
                <td class="bb green"><small class="left">7</small></td>
                <td class="brb green" ><small class="right">0</small></td>
            </tr>
            <tr>
                <td>17</td>
                <td class="brb blue" colspan="8">REL file record length, max value 254</small></td>
            </tr>
            <tr>
                <td>18</td>
                <td class="brb unused" colspan="8" rowspan="6">Unused in CBM DOS, GEOS only</td>
            </tr>
            <tr><td>19</td></tr>
            <tr><td>1A</td></tr>
            <tr><td>1B</td></tr>
            <tr><td>1C</td></tr>
            <tr><td>1D</td></tr>
            <tr>
                <td>1E</td>
                <td class="orange"><small class="left">7</small></td>
                <td class="bb orange" colspan="6" rowspan="2">File size in sectors</td>
                <td class="br orange" ><small class="right">0</small></td>
            </tr>
            <tr>
                <td class="brb">1F</td>
                <td class="bb orange"><small class="left">15</small></td>
                <td class="brb orange" ><small class="right">8</small></td>
            </tr>

            <tr>
                <td>20</td>
                <td class="brb unused" colspan="8" rowspan="2">Must be set to 0x0000</td>
                <td class="brb" rowspan="32">Second Directory entry</td>
            </tr>
            <tr>
                <td>21</td>
            </tr>
            <tr>
                <td>22</td>
                <td class="brb orange">Closed</td>
                <td class="brb yellow">Locked</td>
                <td class="brb grey">Save</td>
                <td class="brb unused"></td>
                <td class="brb grey" colspan="4"><small class="left">3</small><small class="right">0</small>File Type</td>
            </tr>
            <tr>
                <td>23</td>
                <td class="green"><small class="left">15</small></td>
                <td class="bb green" colspan="6" rowspan="2">Location of first sector of file</td>
                <td class="br green" ><small class="right">8</small></td>
            </tr>
            <tr>
                <td>24</td>
                <td class="bb green"><small class="left">7</small></td>
                <td class="brb green" ><small class="right">0</small></td>
            </tr>
            <tr>
                <td>25</td>
                <td class="brb" rowspan="16"></td>
                <td class="brb orange" colspan="7" rowspan="16">Filename in PETASCII padded with 0xA0</td>
            </tr>
            <tr><td>26</td></tr>
            <tr><td>27</td></tr>
            <tr><td>28</td></tr>
            <tr><td>29</td></tr>
            <tr><td>2A</td></tr>
            <tr><td>2B</td></tr>
            <tr><td>2C</td></tr>
            <tr><td>2D</td></tr>
            <tr><td>2E</td></tr>
            <tr><td>2F</td></tr>
            <tr><td>30</td></tr>
            <tr><td>31</td></tr>
            <tr><td>32</td></tr>
            <tr><td>33</td></tr>
            <tr><td>34</td></tr>
            <tr>
                <td>35</td>
                <td class="green"><small class="left">15</small></td>
                <td class="bb green" colspan="6" rowspan="2">Location of first side-sector block</td>
                <td class="br green" ><small class="right">8</small></td>
            </tr>
            <tr>
                <td>36</td>
                <td class="bb green"><small class="left">7</small></td>
                <td class="brb green" ><small class="right">0</small></td>
            </tr>
            <tr>
                <td>37</td>
                <td class="brb blue" colspan="8">REL file record length, max value 254</small></td>
            </tr>
            <tr>
                <td>38</td>
                <td class="brb unused" colspan="8" rowspan="6">Unused in CBM DOS, GEOS only</td>
            </tr>
            <tr><td>39</td></tr>
            <tr><td>3A</td></tr>
            <tr><td>3B</td></tr>
            <tr><td>3C</td></tr>
            <tr><td>3D</td></tr>
            <tr>
                <td>3E</td>
                <td class="orange"><small class="left">7</small></td>
                <td class="bb orange" colspan="6" rowspan="2">File size in sectors</td>
                <td class="br orange" ><small class="right">0</small></td>
            </tr>
            <tr>
                <td class="brb">3F</td>
                <td class="bb orange"><small class="left">15</small></td>
                <td class="brb orange" ><small class="right">8</small></td>
            </tr>

            <tr>
                <td class="dashleft">&nbsp;</td>
                <td colspan="8"></td>
                <td class="dashright">&nbsp;</td>
            </tr>

            </tbody>
        </table>
    </div>
    <div class="col-6">
        <h3>Sector pointers</h3>
        <p>
            The sector pointers at offset 0x00, 0x03 & 0x15 are Track/Sector values.
        </p>
        <p>
            The track number is in the first byte, sector number in the second.
        </p>
        <h4>Next directory sector pointer</h4>
        <p>
            The next directory sector pointer at offset 0 points to the next directory sector in the chain.
            If it's the last entry in the chain then it is set to 0x0000.
        </p>
        <p>
            It is only valid for the first directory entry.
            On file entries other than the first one in the sector this pointer is unused & is set to 0x0000.
        </p>

        <h3>File Type</h3>
        <table class="memoryMap">
            <thead>
            <tr>
                <th>7</th>
                <th>3</th>
                <th>2</th>
                <th>1</th>
                <th>0</th>
                <th>Name</th>
                <th>File Type</th>
            </tr>
            </thead>
            <tbody>
            <tr><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td></td><td>Scratched, deleted file entry</td></tr>
            <tr><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>DEL</td><td>Deleted</td></tr>
            <tr><td>1</td><td>0</td><td>0</td><td>0</td><td>1</td><td>SEQ</td><td>Sequential</td></tr>
            <tr><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>PRG</td><td>Program</td></tr>
            <tr><td>1</td><td>0</td><td>0</td><td>1</td><td>1</td><td>USR</td><td>User</td></tr>
            <tr><td>1</td><td>0</td><td>1</td><td>0</td><td>0</td><td>REL</td><td>Rel</td></tr>
            </tbody>
        </table>
        <p>All other values are illegal and will produce strange results.</p>
        <p>Some routines use all 4 lower bits, some ignore bit 3.</p>
        <p>
            All file types require the <code>Closed</code> flag (bit 7) to be set.
            Only <code>DEL</code> is valid with <code>Closed</code> cleared when it indicates a deleted file entry.
        </p>

        <h3>File length</h3>
        <p>
            The file length is a little endian value with the lsb first, msb last.
            It is a sector count, not the file count.
        </p>

        <h3>REL files</h3>
        <p>
            Bytes with offset 0x15&hellip;0x17 are only used for REL files.
        </p>
    </div>
</div>
